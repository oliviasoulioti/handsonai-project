# Credit Default Prediction Project

## 📌 Εισαγωγή

Η εργασία αυτή στοχεύει στην κατασκευή ενός μοντέλου μηχανικής μάθησης που προβλέπει αν ένας πελάτης πιστωτικής κάρτας θα αθετήσει την πληρωμή του τον επόμενο μήνα. Το πρόβλημα μοντελοποιείται ως δυαδική κατηγοριοποίηση.  
Χρησιμοποιείται το **UCI Credit Card Default Dataset**, το οποίο περιλαμβάνει 30.000 πελάτες με οικονομικά, δημογραφικά και ιστορικά στοιχεία πληρωμών.

---

## 🔍 Προεπεξεργασία Δεδομένων

- **Αντιμετώπιση ακραίων τιμών**: Εφαρμόστηκε λογαριθμικός μετασχηματισμός (`log1p`) στις μεταβλητές με ισχυρή ασυμμετρία (ποσά πιστώσεων, πληρωμών, υπολοίπων).
- **Scaling**: Εφαρμόστηκε `StandardScaler` στις λογαριθμισμένες στήλες.
- **Κατηγοριοποίηση**: Οι μεταβλητές `SEX`, `EDUCATION`, `MARRIAGE` και οι `PAY_*` μετατράπηκαν με `one-hot encoding`.
- **Feature Engineering**: Δημιουργήθηκαν νέα χαρακτηριστικά:
  - `total_bill`, `total_payment`, `pay_to_bill_ratio`
- **Feature Selection**:
  - `SelectKBest` με `f_classif`
  - `RandomForest Feature Importance`
  - Τελικό σύνολο χαρακτηριστικών: η ένωση των 20 σημαντικότερων από κάθε μέθοδο.
- **PCA**: Δοκιμάστηκε με στόχο διατήρηση του 95% της διακύμανσης (έδωσε μόνο 2 συνιστώσες). Τελικά, δεν επιλέχθηκε για το τελικό μοντέλο.

---

## 🤖 Επιλογή & Εκπαίδευση Μοντέλων

### Μοντέλα που επιλέχθηκαν:
- **Random Forest** (παραδοσιακό ML): Αποτελεσματικός σε μικρά και μεσαία structured datasets.
- **MLP (Multi-Layer Perceptron)** με Keras: Αντιπροσωπευτικό νευρωνικό δίκτυο για ταξινόμηση με πλήρως συνδεδεμένα layers.

### Tuning υπερπαραμέτρων:
- **Random Forest**: Βελτιστοποίηση με **Optuna** (n_estimators, max_depth, κ.ά.)
- **MLP**: Βελτιστοποίηση με **KerasTuner** (αριθμός νευρώνων, dropout, learning rate)

---

## 🧠 Ερμηνευσιμότητα

- **Random Forest**: Εφαρμόστηκε **Permutation Importance** για ανάλυση επιρροής χαρακτηριστικών. Τα πιο σημαντικά περιλαμβάνουν το `pay_to_bill_ratio` και `total_payment`.
- **MLP**: Δύσκολο στην ερμηνεία λόγω “μαύρου κουτιού”, χωρίς ενσωματωμένη σημασία χαρακτηριστικών.

---

## 📈 Αποτελέσματα

| Μετρική         | Random Forest | MLP |
|------------------|----------------|-----|
| Accuracy          |  **~82%**       | ~80% |
| F1-score (class 1)|  **~0.59**      | ~0.55 |
| ROC-AUC           |  **~0.75**      | ~0.73 |
| Training Time     | Χαμηλός         | Μέτριος |
| Ερμηνευσιμότητα   | Υψηλή           | Χαμηλή |

🔹 **Καλύτερο μοντέλο**: Random Forest – υψηλότερη ακρίβεια και ερμηνευσιμότητα

---

## 🖥️ API

Υλοποιήθηκε FastAPI `/predict` endpoint που:
- Δέχεται JSON με νέα παρατήρηση
- Εφαρμόζει την ίδια προεπεξεργασία με την εκπαίδευση
- Επιστρέφει την πρόβλεψη του βελτιστοποιημένου μοντέλου

---

## ⚙️ Οδηγίες Εγκατάστασης

```bash
git clone <το repository>
cd credit-default-api
pip install -r requirements.txt
uvicorn main:app --reload
